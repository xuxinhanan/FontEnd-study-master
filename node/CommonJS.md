通过require()导入的模块将按照以下步骤执行：

1. **解析模块路径并加载文件**
2. **包装模块**
3. **执行模块代码**
4. **返回模块导出**
5. **整个模块被缓存**



三种不同的模块：

1. **node的核心模块**：如('http')，当require函数收到模块名称后，就会自动找到该模块的路径并尝试加载它
2. **开发者的模块**：如('./lib/controller')，如果没有该名称的js文件，则会尝试打开该文件夹，并加载其中的index.js文件
3. **第三方npm模块**：如('express')



如果在任何地方都找不到指定模块，则会抛出错误并停止应用程序。

------------

加载完成模块后，模块的代码会被包装成一个特殊的自执行函数，能让我们访问几个特殊的对象。

![image-20221017133537776](C:\Users\64554\AppData\Roaming\Typora\typora-user-images\image-20221017133537776.png)



在node运行时，会从我们的模块中删除代码，并将其放入立即调用函数中。NODE并不是直接执行模块的代码，而是将其通过包装函数执行。

通过这样的方式，我们在模块中定义的变量就不会与其他变量冲突了。

------------

包装函数的返回值（导出对象）就是模块的导出值。



最后模块代码的执行结果将被缓存，换句话说模块代码在多次导入过程中只执行一次。