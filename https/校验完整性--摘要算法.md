实现完整性的手段主要是**摘要算法**，也就是常说的**哈希函数**。

你可以把摘要算法近似地理解成一种特殊的压缩算法，它能够把任意长度的数据“压缩”成固定长度、而且独一无二的“摘要”字符串，就好像是给这段数据生成了一个数字“指纹”。

换一个角度，也可以把摘要算法理解成特殊的“单向”加密算法，它只有算法，没有密钥，加密后的数据无法解密，**不能从摘要逆推出原文。**

<img src="https://static001.geekbang.org/resource/image/28/d8/2865d2c77466efb7a480833bcb27f9d8.png?wh=1417*1382" alt="img" style="zoom:33%;" />

你一定在日常工作中听过、或者用过 MD5（Message-Digest 5）、SHA-1（Secure Hash Algorithm 1），它们就是最常用的两个摘要算法，能够生成 16 字节和 20 字节长度的数字摘要。但这两个算法的安全强度比较低，不够安全，在 TLS 里已经被禁止使用了。

**目前 TLS 推荐使用的是 SHA-1 的后继者：SHA-2。**

-------

### 完整性

> 摘要算法保证了“数字摘要”和原文是完全等价的。所以，我们只要在原文后附上它的摘要，就能够保证数据的完整性。



**比如，你发了条消息：“转账 1000 元”，然后再加上一个消息的摘要。网站收到后也计算一下消息的摘要，把这两份“摘要”做个对比，如果一致，就说明消息是完整的，没有被修改。**

如果黑客在中间哪怕改动了一个标点符号，摘要也会完全不同，网站计算比对就会发现消息被窜改，是不可信的。

不过摘要算法不具有机密性，如果明文传输，那么黑客可以修改消息后把摘要也一起改了，网站还是鉴别不出完整性。

所以，真正的完整性必须要建立在机密性之上，在混合加密系统里用 **会话密钥** 加密消息和摘要，这样黑客无法得知明文，也就没有办法动手脚了。













